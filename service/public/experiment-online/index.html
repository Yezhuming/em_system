<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<title></title>
		<style type = "text/css" >
		 @import "text/button.css";
		 @import "text/jquery.cxcolor.css";
		</style>
		<script src="js/modernizr-custom.js"></script>
		<script src="js/port.js"></script>
		<script src="js/light.js"></script>
		<script src="js/switch.js"></script>
		<script src="js/canvasDraw.js"></script>
		<script src="js/algorithm.js"></script>
		<script src="js/wire.js"></script>
		<script src="js/expBoxArea.js"></script>
		<script src="js/power.js"></script>
		<script src="js/controler.js"></script>
		<script src="js/Status.DBUS.js"></script>
		<script src="js/Status.DR1.js"></script>
		<script src="js/Status.DR2.js"></script>
		<script src="js/Status.ALU.js"></script>
		<script src="js/Status.C.js"></script>
		<script src="js/functionButton.js"></script>
		<script src="js/Status.AR1.js"></script>
		<script src="js/Status.AR2.js"></script>
		<script src="js/Status.RAM.js"></script>
		<script src="js/Status.IR.js"></script>
		<script src="js/Status.RF.js"></script>
		<script src="js/Status.ER.js"></script>
		<script src="js/load.js"></script>
		<script src="js/drawRAM.js"></script>
		<script src="js/drawp.js"></script>
		<script src="js/save.js"></script>
		<script src="js/Status.R4.js"></script>
		<script src="js/Status.PC.js"></script>
		<script src="js/Status.SW.js"></script>
		<script src="js/Status.IAR.js"></script>
		<script src="js/Status.IBUS.js"></script>
	</head>
	<body>
		<div style="position: absolute; top: 0px; left: 0px;">
			<canvas id="canvasOne" width="500" height="300">
				no!
			</canvas>
			<audio src="Button1.wav" id="audio">  
        	</audio> 
			<div id="block">
				<div id="se" class="div-inline">
					<label for="color_b">查找端口：</label>
					<input id = "search" oninput="aa(event)" onporpertychange="aa(event)">
				</div>
				<div id = "select" class="div-inline">
					<label for="color_b">导线颜色：</label>
					<input id="color_b" type="text" class="input_cxcolor" readonly>		
					<div id="result"></div>  
				</div>
				<div id = "save" class="div-inline">
					<a id="test" onclick="clickDownload(this)" download="downlaod.txt" >保存</a>  
				</div>
				<div id = "up" class="div-inline">
			 		<span class="btn btn-success fileinput-button">
            			<span >上传</span>
            			<input type="file"  id="file" >
        			</span>
        		</div>
        		<div id = "onload" class="div-inline">
					<input type="button" id="testButton" value="加载" onclick="mm();">
				</div>
           </div>
		</div>
	</body>
		<script>
			var ckm;
			var re; var _time; var _time2; var t3=0; 
			var t2=0; var TJ = 0;															//用来保存正在进行的时间函数
			var wr;var rr1;var speed = 500;
			var lrectflag = [0,0,0,0,0,0]; 													//矩形颜色切换
			var rectflag = [0,0,0,0,0,0,  0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0];	
			var srectflag = [0,0,0,0,0,0,0,0]; 	var zrectflag = [0,0,0,0,0,0,0]; 
			var rr2 =  new Array(150);  
			var setnumber = createSetnumber();
			var diamondRedOrBlack = [1,1,1,1];  													//判断P是否有红框
			for(var i = 0;i < rr2.length; i++)  
  				 rr2[i] = new Array(4);    //每行有10列  
			function readAsText()     //读
			{  
    			var file = document.getElementById("file").files[0];  
    			var reader = new FileReader();  
    			reader.readAsText(file);  
    			reader.onload = function(e)  
    			{  
        			var result = document.getElementById("result");  
        			re = result.innerHTML=this.result;  
      				rr1 = re.split("!");
      				alert(rr1[0]);
					for (var i = 0; i < rr1.length/4; i++)
					{
						for(var j = 0; j < 4; j++)
							rr2[i][j] = rr1[i*4+j];
					}
    			}  		
			}
    		
			var test=document.getElementsByTagName('html');		//保存相关
			console.log(test);
			var ourWidth = screen.width;					//当前屏幕的大小
			var ourHight = screen.height;					//当前屏幕的大小
			
			//确定ourHight
			if(ourWidth > ourHight)
			{
				ourHight = ourHight*19/20;
			}
			else
			{
				ourHight = ourWidth * 4 / 5;
			}
			var se;
			function aa(e){ se = document.getElementById("search").value; }
			var audio = document.getElementById("audio");   //声音
			var expBox_x = (ourWidth/10);					//实验箱x开始值
			var expBox_y =  (ourHight/8);					//实验箱的y开始值
			var expBox_long = (ourWidth*4/5);				//实验箱的长
			var expBox_Height = ourHight;					//实验箱的高度
			var isHighorLow = 0;								//判断高低电平
			
			var widthNum = 74 , heightNum = 40;				//网格行数，列数
			var perWidth = (expBox_long / widthNum); 		//每个网格的长
			var perHeight = (expBox_Height / heightNum); 	//每个网格的高
			
			var Port = createPort();						//一堆端口变量
			var PortIDLab = createPortIDLab();
			var Light = createLight();
			var Switch = createSwitch();
			var Wire = createWire();
			var color = "firebrick";						//导线默认颜色
			var selectWire = -1;							//选中的导线的id
			var isOverlap = -1;
			
			var DBUS = createDBUS();						//各个器件
			var DR1 = createDR1();
			var SW = createSW();
			var DR2 = createDR2();
			var ALU = createALU();
			var C = createC();                                                     
			var AR1 = createAR1();
			var AR2 = createAR2();
			var IR = createIR();
			var RAM = createRAM();
			var RF = createRF();
			var ER = createER();
			var R4 = createR4();
			var PC = createPC();
			var IAR = createIAR();
			var IBUS = createIBUS();
			var micSwitch = createMicSwitch();
			var aac = ['0','0','0','0','0','0','0','0'];
			var bbc = ['0','0','0','0','0','0','0','0'];
			var km; var km2;  var greenlight;//绿灯二进制
			var a_canvas1;var counti = 1;var count2 = 0;var isdbuslight=0;var a;var b;var jj;var cc;
			var isRamHideZero = 1;
			var name;
			var IR1 ,IR2;//IR指令
			var rednum = [0,0,0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0];
			var com = [1,1,1,1,1,1,1,1,1,1,  1,1,1,1,1,1,1,1,1,1,  1,"00","00","00","00","00",0,0,0,"FF",  
			0,"00",1,"00","00","00","00","00","00","00"  ,"00",0];												//展示sw等开关
			//com[20]:RAM;   com[21]:AR1;   com[22]:AR2;  com[23]:sum;
			//com[24]:DR1;   com[25]:DR2;   com[26]:S2;   com[27]:S1;  com[28]:S0;    com[29]:DBUS; 
			//com[30]:IBUS;  com[31]:IR;	com[32]:LRW   com[33]:ER   com[34]:RF(00) com[35]:RF(01);
			//com[36]:RF(10) com[37]:RF(11) com[38]:PC    com[39]:IAR  com[40]:R4     com[41]:C(进位)
			var flag = 0;          		
			window.addEventListener("load", eventWindowLoaded, false);				            //页面加载完毕后画图
			function eventWindowLoaded()														//执行的函数
			{
				var thecanvas = document.getElementById("canvasOne");
				var mouseX, mouseY;																//保存鼠标当前地址
				canvasApp();																	//画界面				
				thecanvas.addEventListener("mousemove", eventMouseMove, false);
				thecanvas.addEventListener("click", eventMouseClick, false);
				thecanvas.addEventListener("dblclick",eventDblclick,false);
				
				var turn = 1;																	//切换数据通路
				var erflag = 0, flag1 = 0, flag2 = 0;
				var sw = 0,lder = 0;
				var drm=[0,0,0, 0,0,0, 0,0,0, 0,0,0, 0,0];
				var tsum = 0;	
			
				function eventMouseMove(event)          
				{
					
					color = document.getElementById("color_b").value;
					function aa(e){ se = document.getElementById("search").value; }
					drm[13] = re;var type;var id;
					var x, y;
					if(event.pageX || event.pageY)												//鼠标有移动
					{
						x = event.pageX;
						y = event.pageY;
					}
					else
					{
						x = e.clientX + document.body.scrollLeft +document.documentElement.scrollLeft;
						y = e.clientY + document.body.scrollTop +document.documentElement.scrollTop;
					}
					
					x -= thecanvas.offsetLeft;
					y -= thecanvas.offsetTop;
					
					mouseX = x;
					mouseY = y;
					isOverlap = isWireOverlap();
					if(Power.value == true)
						isswitch(mouseY,mouseX,type,id);
					if((Wire[0] != null || Wire[0] != undefined))				//当Wire[0]非空，有导线未完成，一直画，直到完成
					{
						var endpoint = new pointPro(mouseX,mouseY);
						Wire[0].theEndPoint = endpoint;							//更新未完成的终点
						clearCanvas();
						canvasApp();
						drawWire();
					}//是否在画导线
					
					
					if(Wire.length > 1)											//在导线地图范围内
					{
						var nowWire = isWire();
						
						if(nowWire != -1)    									//有选中的导线
						{
							if((nowWire != selectWire))			//当前选中导线不等于之前选中的导线值
							{
								if(selectWire != -1)							//之前导线不等于-1
								{
									Wire[selectWire].isSelect = false;
								}							
								Wire[nowWire].isSelect = true;
						    	selectWire = nowWire;
						    	clearCanvas();
						    	canvasApp();
						    	drawWire();
						    	if(flag == 1)										//修复了碰到线就会闪的bug
						    		drawp();
							}							
						}
						else														//无选中导线
						{
							if((selectWire != -1) )									//之前有选中导线
							{
								Wire[selectWire].isSelect = false;
								selectWire = nowWire;
								clearCanvas();
						    	canvasApp();
							}
							if(flag == 1 )											//修复了碰到线就会闪的bug    
						    	drawp();
						}
					}//在实验箱内
					if(ramHideZero() == 1)
					{
						 context.fillText("隐藏",expBox_x+expBox_long*0.6+perWidth*2,  expBox_y+expBox_Height*0.33);
					}
					function ramHideZero()
					{
						if(mouseX > expBox_x+expBox_long*0.6+perWidth*3 && mouseX < expBox_x+expBox_long*0.6+perWidth*3.8
							&& mouseY > expBox_y+expBox_Height*0.33 && mouseY < expBox_y+expBox_Height*1.13)
							return 1;
						else
							return -1;
					}
					
					function isWireOverlap()															//判断导线是否重叠
					{
						var minY,maxY;
						for(var i = 1 ; i < Wire.length ; i++)
						{
							var currentWire = Wire[i];
							var length = currentWire.wirePath.length;
							
						    if(mouseX > expBox_x+(currentWire.wirePath[0].Y+1)*perWidth - 2         //鼠标的X轴不变，Y轴变。通过路径的X可以计算出Y的范围
							   && mouseX < expBox_x+(currentWire.wirePath[0].Y+1)*perWidth + 2)
						    {	
						    	maxY = expBox_y+(currentWire.wirePath[0].X+1)*perHeight;
								minY = expBox_y+(currentWire.wirePath[1].X+1)*perHeight;
								if(mouseY > minY && mouseY < maxY)
								{						
									//alert(currentWire.theEndPoint.name);
									return currentWire.theEndPoint.name;
								}	
						    }
							if(mouseX > expBox_x+(currentWire.wirePath[length-2].Y+1)*perWidth - 2         //鼠标的X轴不变，Y轴变。通过路径的X可以计算出Y的范围
							   && mouseX < expBox_x+(currentWire.wirePath[length-2].Y+1)*perWidth + 2)
						    {
						    	
						    	minY = expBox_y+(currentWire.wirePath[length-2].X+1) * perHeight;
								maxY = expBox_y+(currentWire.wirePath[length-1].X+1) * perHeight;
								if(mouseY > minY && mouseY < maxY)
								{						
									//alert(currentWire.theStartPoint.name);
									return currentWire.theStartPoint.name;
								}	
						    }    			    
						}
						return -1;
					}
					function isWire()
					{
						for(var i = 1 ; i < Wire.length ; i++)
						{
							var currentWire = Wire[i];
							var length = currentWire.wirePath.length;
							
						    for( var j = 0 ; j < length-1 ; j++)											//遍历导线所有路径
						    {
								if(currentWire.wirePath[j].X == currentWire.wirePath[j+1].X)				//水平的导线
								{									
									if(mouseY > expBox_y+(currentWire.wirePath[j].X+1)*perHeight - 2
									&& mouseY < expBox_y+(currentWire.wirePath[j].X+1)*perHeight + 2)		//鼠标的y轴相同,鼠标的X轴变。通过路径的Y可以计算出X的范围
									{
										if(currentWire.wirePath[j].Y <= currentWire.wirePath[j+1].Y)
										{
											var minX = expBox_x+(currentWire.wirePath[j].Y+1)*perWidth;
											var maxX = expBox_x+(currentWire.wirePath[j+1].Y+1)*perWidth;
										}
										else
										{
											var maxX = expBox_x+(currentWire.wirePath[j].Y+1)*perWidth;
											var minX = expBox_x+(currentWire.wirePath[j+1].Y+1)*perWidth;
										}//两点间X的范围	
										if(mouseX > minX && mouseX < maxX)
										{
											return i;
										}
									}									
								}
								else
								{//垂直的导线,X变
									if(mouseX > expBox_x+(currentWire.wirePath[j].Y+1)*perWidth - 2
									&& mouseX < expBox_x+(currentWire.wirePath[j].Y+1)*perWidth + 2)
									{//鼠标的X轴不变，Y轴变。通过路径的X可以计算出Y的范围
										if(currentWire.wirePath[j].X <= currentWire.wirePath[j+1].X)
										{
											var minY = expBox_y+(currentWire.wirePath[j].X+1)*perHeight;
											var maxY = expBox_y+(currentWire.wirePath[j+1].X+1)*perHeight;
										}
										else
										{
											var maxY = expBox_y+(currentWire.wirePath[j].X+1)*perHeight;
											var minY = expBox_y+(currentWire.wirePath[j+1].X+1)*perHeight;
										}//两点间X的范围
																			
										if(mouseY > minY && mouseY < maxY)
										{
											return i;
										}
									}										
								}//垂直的导线,X变
							}//检索完该导线所有路径				
						}//检索完所有的导线						
						return -1;
					}//isWire()	
				}//EventMouseMove()			
				function eventMouseClick()
				{	 
					var id = -1;	
					
					var type = new String();
					isSelect();
					if(type == "Switch" && id != -1 )//&& (Wire[0] == null || Wire[0] == undefined))				//点击开关	
					{	
						com[23] = 0;
						audio.play(); 
						Switch[id].value = !(Switch[id].value);						
						if(Power.value == true)
						{
							expBox();			
							isHighorLow = 1;
						}
						if(Power.value == true)
							SW.running();				
						if(flag == 1)drawp();
						//tsum = com[23];
						if(flag == 1)												//打开了数据通路
						{
							if(Power.value==true)
								openGate(id);
						}		
						
						clearCanvas();canvasApp();if(flag==1)drawp();
					}
					
					else if(type == "Port" && id != -1 && Power.value == false)		//点击插口
					{
						if(flag == 0)
						{
							if((Wire[0] == null || Wire[0] == undefined))				//Wire来自createwire的数组
							{
								var startpoint = Port[id];							    //Port来自createport的数组
								var endpoint = new pointPro(mouseX,mouseY);             //未完成的终点
								var _wire = new wirePro(startpoint,endpoint,color);
								Wire[0] = _wire;
							}
							else														//结束一条导线
							{
								var endpoint = Port[id];
								Wire[0].theEndPoint = endpoint;
								var x;
								x = Wire[0].theStartPoint.x;
								Wire[0].wirePath = AStar(new node(Wire[0].theStartPoint.y-1,Wire[0].theStartPoint.x-1), new node(Wire[0].theEndPoint.y-1,Wire[0].theEndPoint.x-1));
								if(Wire[0].theStartPoint.type == Wire[0].theEndPoint.type)
								{
									Wire[0].isNormal = false;
								}
								Wire.push(Wire[0]);
								Wire[0] = null;	
							}
							clearCanvas();
							canvasApp();
						}
					}				
					else if(type == "power")										//选中电源
					{				
						
						Power.value = !Power.value;
						if(Power.value == true)
						{		
							SW.running();	
							expBox();	
							isHighorLow = 1;
							MF();
							for(var i = 0; i < Switch.length; i++)
							{
								openGate(i);
							}
						}
						else
						{
							com = [1,1,1,1,1,1,1,1,1,1,  1,1,1,1,1,1,1,1,1,1,  1,"00","00","00","00","00",0,0,0,"FF",  
							0,"00",1,"00","00","00","00","00","00","00"  ,"00",0];
							clearTimeout(_time);						
							expBox();	
							clearRect();
							isHighorLow = 0;
						}
						clearCanvas();
						canvasApp();
						if(flag==1)drawp();
					}
					else if(type == "blackrect")      //数据通路小黑长方形
					{
						com[id]=-com[id];
						if(Power.value == true)
						{				
							clearCanvas();canvasApp();if(flag==1)drawp();
							expBox();								
							isHighorLow = 1;com[23] = tsum;
							clearCanvas();canvasApp();if(flag==1)drawp();
						}
					}
					else if(type == "micswitch")                                                     //微动开关
					{
						if(Power.value == true)
						{
							if(id == 0)																//QD
							{				
								IR.running();
								if(Switch[27].value == false && Switch[28].value == false && Switch[29].value == false)//连续
								{
					
									counti = 1; t2 = 1; showtime();
								}
								if(Switch[27].value == true && Switch[28].value==false && Switch[29].value == false)//单拍
								{
									t3 = 1;
									showT();
									showtime2();
									
									count2++;
								}			
							}
							if(id == 1)																//CEL#
							{
								clearRect();
								clearTimeout(_time); 
								t2 = 0;
								TJ = 0;	
								count2 = 0;
								for(var i = 8; i <= 13; i++)
									Light[i].value = false;
								for(var i = 22; i <=27; i++)
									Light[i].value = false;
								srectflag[6] = 1;refreshLightp(3);diamondRedOrBlack[3] = 0;
								clearCanvas();
								canvasApp();
								if(flag == 1)
									drawp();
							}

						}	
					}
					else if(type == "trans")     //LRW小三角形
					{
						com[32] = -com[32]; drawp();
					}
					else if(type == "ramhidezero")
					{
						isRamHideZero = -isRamHideZero;
						clearCanvas();canvasApp();if(flag==1)drawp();
					}
					
					else if(type == "setnumber")                                        //点击寄存器数据数据
					{
							name = prompt("请输入数据："); 
							if(name != "")
							switch(id)
							{
								case 0: com[25] = name; break; case 1: com[24] = name; break; case 2: com[33] = name; break; case 3: com[23] = name; break;
								case 4: com[21] = name; break; case 5: com[22] = name; break; case 6: com[39] = name; break; case 7: com[38] = name; break;
								case 8: com[40] = name; break; case 9: com[31] = name; break; case 10:com[34] = name; break; case 11:com[35] = name; break;
								case 12: com[36] = name;break; case 13:com[37] = name; break; 
							}
							clearCanvas();canvasApp();if(flag==1)drawp();											
					}
					
					else if(type == "ramdonAndClearzero")
					{
						if(id == 1)
						{
							for(var i = 0; i < RAM.ram1.length; i++)
							{
								for(var j = 0; j < RAM.ram1[i].length; j++)
								{									
									var temp = Math.floor(Math.random()*255).toString(16);
									if(temp.length == 1)
										temp = '0' + temp;
									RAM.ram1[i][j] = temp;
								}		
							}
							random();
						}
						if(id == 2)
						{
							for(var i = 0; i < RAM.ram1.length; i++)
							{
								for(var j = 0; j < RAM.ram1[i].length; j++)
								{
									RAM.ram1[i][j] = "00";
								}		
							}
							clearZero();
						}
						clearCanvas();canvasApp();if(flag==1)drawp();					
					}
					else if(type == "button")
					{
						
						switch(id)
						{
							case 0:
							{
								if(Power.value == false)
								{
									revokeWire();
									clearCanvas();
									canvasApp();
								}								
								break;
							}
							case 1:
							{
								if(Power.value == false)
								{
									clearWire();
									clearCanvas();
									canvasApp();
								}								
								break;
							}
							case 2:
							{	
								speed = speed - 500;
								break;
							}
							case 3:
							{
								speed = speed + 500;
								break;
							}
							case 4:
							{
								if(turn == 1)								
								{
									refreshLightr();
									srectflag[6] = 1;diamondRedOrBlack[3] = 0;
									canvasApp();
									drawp();
									flag = 1;										
								}
								if(turn == -1)
								{
									rem();		
									canvasApp();
									flag = 0;
								}	
								turn = -turn;								
								break;
							}
						}
					}
					
					function isSelect()																		//选中开关？
					{		
						if(mouseY > (expBox_y+Switch[0].y*perHeight) && mouseY < (expBox_y + 
							Switch[Switch.length-1].y*perHeight + perHeight*5/4))							//在Switch的y范围内
						{
							for(var i = 0 ; i < Switch.length ;)
							{
								if(mouseY > (expBox_y+Switch[i].y*perHeight))								//大于当前未知范围的最小值
								{
									if(mouseY < (expBox_y+Switch[i].y*perHeight + perHeight*5/4))			//小于未知范围中最近的一个值的最大值
									{
										if(mouseX > (expBox_x+Switch[i].x * perWidth))						//大于当前未知范围的X最小
										{	
											if(mouseX < (expBox_x+Switch[i].x*perWidth + perWidth))			//匹配
											{
												type = "Switch";
												id = i;
												return;
											}
											else
											{
												i++;
											}
										}
										else																//小于当前未知范围的最小值
										{			
											break;
										}
								    }
									else																	//小于当前未知范围的最小值
								    {
								    	if(i < Switch.length - 2)
								    	{
								    		i = i + Switch.length - 2;										//下一行所在的位置
										}
								    	else
								    	{
											i++;
										}
								    }   
							    }
								else
							    {
							    	break;
							    }
							}
					    }//选中开关
						else if(mouseY > (expBox_y + Port[0].y * perHeight - perWidth/2) &&					//在插口的范围
						  mouseY < (expBox_y + Port[Port.length-1].y * perHeight + perWidth))
						{
							for(var i = 0 ; i < Port.length ; i++)
							{
								dx = mouseX - (expBox_x+Port[i].x*perWidth);
								dy = mouseY - (expBox_y+Port[i].y*perHeight);
								if(Math.sqrt(dx * dx + dy * dy) < perWidth/2)
								{
									id = i;
									type = "Port";
									return;
								}
							}							
						}
						
						if(mouseX > expBox_x + Power.x*perWidth&& mouseX < expBox_x + Power.x*perWidth + 3*perWidth        //选中电源
						    && mouseY > expBox_y + Power.y*perHeight && mouseY < expBox_y+Power.y*perHeight+perHeight)
						{
						        	type = "power";
						        	return;
						}
						
						if(mouseX > expBox_x + Button[0].x*perWidth
						&& mouseX < expBox_x + expBox_long
						&& mouseY > expBox_y + Button[0].y*perHeight
						&& mouseY < expBox_y + expBox_Height)
						{
							for(var i = 0 ; i < Button.length ; i++)
							{
								if(mouseX > expBox_x + Button[i].x * perWidth)
								{
									if(mouseX < expBox_x + (Button[i].x+3) * perWidth)
									{
										if(mouseY > expBox_y+Button[i].y*perHeight)
										{
											if(mouseY<expBox_y+(Button[i].y+1)*perHeight)
											{
												type = "button";
												id = i;
												return;
											}
										}
									}
								}
							}
						}
						var blackrect = createblackrect();
						for(var i = 0; i < blackrect.length; i++)
						{
							if((mouseX > expBox_x + blackrect[i].x * perWidth) && (mouseX<expBox_x + blackrect[i].x * perWidth + 1.32*perWidth)
							&&(mouseY > expBox_y + expBox_Height * 0.21 + blackrect[i].y * perHeight) && (mouseY < (expBox_y + expBox_Height * 0.24 + blackrect[i].y * perHeight)))
								{type  = "blackrect"; id = i; return ;}
							
						}
						var t = expBox_y+expBox_Height*0.21;
						if((mouseX >= expBox_x + 23.7*perWidth) && (mouseX <= expBox_x + 24.7*perWidth)
						&& (mouseY >= t + perHeight) && (mouseY <= t + 1.5*perHeight))
						{
							type = "trans";return ;
						}
						
						for(var i = 0; i < micSwitch.length; i++)
						{
							if((mouseX >= expBox_x + micSwitch[i].x * perWidth) && (mouseX <=  expBox_x + micSwitch[i].x * perWidth + 1.2 * perWidth) 
							&& (mouseY >= expBox_y + micSwitch[i].y * perHeight) && (mouseY <= expBox_y + micSwitch[i].y * perHeight + 2.6 * perHeight))
							{
								type = "micswitch";
								id = i; return ;
							}
						}
						if(mouseX > expBox_x + expBox_long*0.6+perWidth*3 && mouseX < expBox_x + expBox_long * 0.6 + perWidth * 3.8
							&& mouseY > expBox_y + expBox_Height * 0.33 && mouseY < expBox_y + expBox_Height * 0.33 + perWidth * 0.8)
						{
							type = "ramhidezero";
							return ;
						}
						if(mouseX > expBox_x + perWidth * 0.5 && mouseX < expBox_x + perWidth * 3.5
						   && mouseY > expBox_y + expBox_Height * 0.21 + perWidth * 0.3 && mouseY < expBox_y + expBox_Height * 0.21 + perWidth * 1.3)
						{
							type = "ramdonAndClearzero";
							id = 1;
							return ;
						}
						if(mouseX > expBox_x + perWidth * 4 && mouseX < expBox_x + perWidth * 7
						   && mouseY > expBox_y + expBox_Height * 0.21 +perWidth * 0.3 && mouseY < expBox_y + expBox_Height * 0.21 + perWidth * 1.3)
						{
							type = "ramdonAndClearzero";
							id = 2;
							return ;
						}
						
						for(var i = 0; i < setnumber.length; i++)
						{
							if(mouseX > expBox_x + perWidth * setnumber[i].x && mouseX < expBox_x + perWidth * setnumber[i].addx
							&& mouseY > t + perHeight * setnumber[i].y && mouseY < t + perHeight * setnumber[i].addy)
							{
								type = "setnumber";
								id = i;
								return;
							}
						}
					    return;
				    }//isSelect()
				}//eventMouseClick()
				
				
				function eventDblclick()
				{
					if(selectWire != -1 && Power.value == false)							//selectWire :选中导线的ID
					{
						if(removeWire())
						{
							clearCanvas();
							canvasApp();
						}						
					}
				}			
			}
			
			function canvasSupport()
			{
				return Modernizr.canvas;
			}			
			ckm = document.getElementById("color_b").value;	
		</script>
	<script src="http://cdn.staticfile.org/jquery/1.7.2/jquery.min.js"></script>
		<script src="js/jquery.cxcolor.min.js"></script>
		<script>
		$('#color_b').cxColor({
			color:'red'
		});
		</script>
	
</html>
